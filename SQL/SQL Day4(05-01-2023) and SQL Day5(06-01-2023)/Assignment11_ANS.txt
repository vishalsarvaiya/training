Table Used: 
===========
student (recid, rollno, fname, sname, surname, admitdate, birthdate, standard, sex)

create table vishalstudent
( recid int not null,
roll no 

Write a query for following requirement:
=======================================

Q-1	Display Full Name of all the male students whose first name ends with "h" and are admitted between 1st January 2006 to 1st August 2006.

	Eg:

	|----------------------|
	|FULL NAME	       |	
	|----------------------|
	|Kamlesh Rajubhai Patel|
	------------------------

	Here "Kamlesh" is the value of 'fname' column, "Rajubhai" of 'sname' and "Patel" of 'surname' column. And first character is in capital for fname, sname, surname and each column value is separated by single space.


CREATE TABLE `trainee`.`vishalstudent` (
  `recid` INTEGER UNSIGNED primary key AUTO_INCREMENT,
  `rollno` NUMERIC(3) NOT NULL,
  `fname` CHAR(25) NOT NULL,
  `sname` CHAR(25) NOT NULL,
  `surname` CHAR(25) NOT NULL,
  `admitdate` DATE  NOT NULL,
  `birthdate` DATE  NOT NULL,
  `standard` NUMERIC(2) NOT NULL,
  `sex` CHAR(10) NOT NULL,
 
)


insert into vishalstudent values(001,1,'kamlesh','rajubhai','patel','2006-01-01','2000-01-01',1,'male');

select concat(fname,' ',sname,' ',surname) as "FULL NAME" from vishalstudent
where admitdate between '2006-01-01' AND '2006-08-01'
and fname like '%h';


Tables Used:
===========


Tables Used:
===========

1) product (recid, mfrid, description, price, qtyonhand)

2) orders (recid, customerid, orderdate, salesrepsid, productid, qty, amount)  customerid , salesrepsid ,  productid

3) customer (recid, company, salesrepsid, creditlimit)  salesrepsid, 

4) salesreps (recid, name, officeid, designation, hiredate, manager, quota, sales, age) officeid

5) office (recid, city, region, manager, targetsales, actualsales)




1) product (recid, mfrid, description, price, qtyonhand)
CREATE TABLE vishalproduct(
  recid NUMERIC(3)   primary key,
  mfrid NUMERIC(3) NOT NULL,
  description CHAR(250) NOT NULL,
  price NUMERIC(5) NOT NULL,
  qtyonhand NUMERIC(4) NOT NULL
 
);


insert into vishalproduct values(001,011,'good quality product',999,70);



2) orders (recid, customerid, orderdate, salesrepsid, productid, qty, amount)
CREATE TABLE vishalorders(
  recid NUMERIC(3)   primary key,
  customerid NUMERIC(3) not null,
orderdate date not null,
  salesrepsid NUMERIC(3) NOT NULL,
  productid NUMERIC(3) NOT NULL,
  qty numeric(4) NOT NULL,
  amount numeric(5) NOT NULL,
FOREIGN KEY (customerid) REFERENCES customer (recid),
FOREIGN KEY (salesrepsid) REFERENCES salesreps(recid),
FOREIGN KEY (productid) REFERENCES product(recid)
);

insert into vishalorders values(001,001,'2022-05-03',001,001,70,999);



3) customer (recid, company, salesrepsid, creditlimit)
CREATE TABLE vishalcustomer(
  recid NUMERIC(3)   primary key,
  company char(30) not null,
 salesrepsid NUMERIC(3) NOT NULL FOREIGN KEY REFERENCES product(recid),
  creditlimit numeric(5) NOT NULL
);


insert into vishalcustomer values(001,'lenovo',001,70000);




4) salesreps (recid, name, officeid, designation, hiredate, manager, quota, sales, age)
CREATE TABLE vishalsalesreps (
  recid NUMERIC(3)   primary key,
  name char(30) not null,
 officeid NUMERIC(3) NOT NULL FOREIGN KEY REFERENCES product(recid),
designation varchar(20) not null,
hiredate date not null,
manager char(20) not null,
quota varchar(20) not null,
sales varchar(5) not null,
age numeric(2) not null
);

insert into vishalsalesreps values(001,vishal,001,'programmer','2022-05-03','johndoe','general',70,21);




5) office (recid, city, region, manager, targetsales, actualsales)

CREATE TABLE vishaloffice(
  recid NUMERIC(3)   primary key,
  city char(30) not null,
 region char(30) NOT NULL,
manager char(20) not null,
targetsales varchar(5) not null,
actualsales) varchar(5) not null
);


insert into vishaloffice values(001,'ahmedabad',east,'johndoe',70,21);


Write queries for below requirements:
=====================================

Q-1	Find Name of all those sales representatives whose offices are in cities ending with 
	"pur" and who have atleast 2 customers. The sales representative must be hired before 
	1st January 2006 and his/her minimum age should be 21 yrs.

	Display fields : Sales Rep. Name, Office City, No. of Customers, Hired on
add cudtomer data
name>salesrep city>office atleast 2 customer hired before 1st January 2006  minimum age> 21 yrs.

select s.name, o.city, s.age, count(c.recid) as 'no. of cust' , s.hiredate from
vishalsalesreps s inner join vishaloffice o
on s.officeid = o.recid
inner join
vishalcustomer c
on c.salesrepsid = s.recid
group by s.recid
having city like '%pur' AND  count(c.recid)>=2
AND s.age>=21 AND s.hiredate<'2006-01-01' ;

Q-2	Find following information for each customer:

	Display fields : Company Name, Sales Rep. Name, Sales Rep. Office City, Company Credit

company>customer name>Sales Rep city>office creditlimit>customer

select c.company,s.name,o.city,c.creditlimit 
from vishaloffice o inner join vishalsalesreps s
on o.recid = s.officeid
inner join
vishalcustomer c
on c.salesrepsid = s.recid;


Q-3	Find following information for each office:

	Office city, Total Sales Rep., Total sale by all sales Rep.,
	Target Sales, Actual Sales, Difference of Target and Actual Sales.

	Display fields : Office City, No. of Sales Rep., Total Sale, Target Sales, Actual  Sales, Difference.

select o.city as "Office City" ,count(s.recid) "No. of Sales Rep" ,sum(s.sales) " Total Sale",
o.targetsales as "Target Sales" , o.actualsales as "Actual  Sales" , (targetsales-actualsales) as "Difference"
from vishaloffice o inner join vishalsalesreps s
on o.recid=s.officeid
group by officeid;

Q-4	Find following information for each product:

	Product description, Price, Quantity on hand, Total no. of 
	orders for each product, Total quantity ordered, Total amount of the orders for each product.

	Display fields : Description, Price, Quantity, Orders, Quantity, Total Amount

select p.description, p.price, p.qtyonhand, o.qty, o.orders

 select p.description, p.price, p.qtyonhand, o.count(productid), o.sum(qty), o.sum(amount) 
    from vishalproduct  as p inner join vishalorders as o
    on p.recid = o.productid
    group by productid;


Q-5	Find order details for all the customers. There will be one row per customer displaying 	
	total quantity ordered by them and the amount spent by each customer.
	
	Display fields : Company Name, Total Quantity Ordered, Total Amount

 select company,sum(qty),sum(amount)
    from vishalcustomer as cus inner join vishalorders as ord
    on cus.recid = ord.customerid
    group by ord.customerid;

Q-6	Display all the sales representatives hired within the past five years from today along with thier Quota and 
	Sales information.
	
	Display fields : Sales Rep. Name, Hired on, Quota, Sales
	
 select name,hiredate,quota,sales from vishalsalesreps
    where hiredate>subdate(now(),interval 5 year);


Q-7	Find total number of customers for all the products ordered. There will be one row per 	
	order displaying product description, and total number of customers who have ordered 	that product.

	Display fields : Product Description, Total No. of Customers who Ordered this Product.


 select description,count(productid)
    from vishalproduct as pro inner join vishalorders as o
    on pro.recid=o.productid
    group by productid;